<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shop - Jaura & Co</title>
  <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico">
  <link rel="stylesheet" href="/ClothingSite/styling/clothes.css">
  <!-- add Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <!-- add Font Awesome for icons-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <script>
    async function addToCart(event, productId, name, price, imageUrl) {
      // prevent the form from submitting
      event.preventDefault(); 
      // each form adds 1 item
      const quantity = 1;

      try {

        const response = await fetch('/cart/add', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ productId, name, price, quantity, imageUrl }),
        });

        if (response.ok) {
          showPopup(`${name} has been added to your cart!`, 'Added to Cart');
          // redirect to cart after adding item
          // window.location.href = '/cart';  // Redirect to the cart page
        } else {
          showPopup('Please Log In or Sign Up before adding items to cart.', 'Authentication Required!');
        }
      } catch (error) {
        console.error('Error adding item:', error);
      }
    }

    // function to show the custom popup
    function showPopup(message, headerText = "Item added to cart") {
      const popup = document.getElementById("popup");
      const popupMessage = popup.querySelector("p");
      const popupHeader = document.getElementById("popup-header");

      popupMessage.textContent = message;
      // update header dynamically
      popupHeader.textContent = headerText; 
      // Show the popup
      popup.style.display = "flex";
    }


    // function to close the popup
    function closePopup() {
      const popup = document.getElementById('popup');
      // hide the popup
      popup.style.display = 'none';
    }

    // ensure event listeners are correctly attached
    document.addEventListener('DOMContentLoaded', () => {
      const closeBtn = document.getElementById('popup-close');
      const popupButton = document.getElementById('popup-button');

      if (closeBtn) {
        closeBtn.addEventListener('click', closePopup);
      }

      if (popupButton) {
        popupButton.addEventListener('click', closePopup);
      }
    });

  </script>
</head>

<body>
  <!-- navigation bar -->
  <header class="navbar">
    <div class="container">
      <h1 class="logo">JAURA & CO</h1>
      <nav>
        <ul class="nav-links">
          <li><a href="/"><i class="fas fa-home"></i> Home</a></li>
          <li><a href="/search"><i class="fas fa-search"></i> Search</a></li>
          <li><a href="/clothes" class="active"><i class="fas fa-tshirt"></i> Shop</a></li>
          <li><a href="/about"><i class="fas fa-info-circle"></i> About</a></li>
          <li><a href="/cart"><i class="fas fa-shopping-cart"></i> Cart</a></li>
          <li><a href="/account"><i class="fas fa-user"></i> Account</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- shop hero section -->
  <section class="shop-hero">
    <div class="container">
      <h2>Shop the Latest Trends</h2>
      <p>Discover our curated collection of premium clothing</p>
    </div>
  </section>

  <!-- products section -->
  <section class="products" id="products">
    <div class="container">
      <div class="product-grid">
        <% products.forEach(product => { %>
          <div class="product-card">
            <div class="product-image">
              <img src="<%= product.image %>" alt="<%= product.name %>">
              <div class="product-overlay">
                <span class="category-tag"><i class="fas fa-tag"></i> <%= product.category %></span>
              </div>
            </div>
            <div class="product-details">
              <h3><%= product.name %></h3>
              <p class="price">£<%= product.price.toFixed(2) %></p>
              <form onsubmit="addToCart(event, <%= product.id %>, '<%= product.name.replace(/'/g, "\\'") %>', <%= product.price %>, '<%= product.image.replace(/'/g, "\\'") %>')">
                <button type="submit" class="add-to-cart-btn">
                  <i class="fas fa-shopping-cart"></i> Add to Cart
                </button>
              </form>
            </div>
          </div>
        <% }); %>
      </div>
    </div>
  </section>

  <!-- popup for cart notification -->
  <div id="popup" class="popup">
    <div class="popup-content">
      <span class="popup-close" id="popup-close">×</span>
      <h2 id="popup-header"></h2>
      <p></p>
      <button id="popup-button">Continue Shopping</button>
    </div>
  </div>

  <!-- footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="clothes">Shop</a></li>
            <li><a href="about">About Us</a></li>
            <li><a href="search">Search</a></li>
            <li><a href="cart">Cart</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Contact Us</h3>
          <p><i class="fas fa-envelope"></i> info@jauraandco.com</p>
          <p><i class="fas fa-phone"></i> +44 123 456 789</p>
        </div>
        <div class="footer-section">
          <h3>Follow Us</h3>
          <div class="social-links">
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 Jaura & Co. All Rights Reserved.</p>
      </div>
    </div>
  </footer>
</body>

</html>